<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<title>D!CTATOR</title>

<style>
body{
  background:black;
  color:white;
  font-family:Arial;
  text-align:center;
}

/* logo */
.logoText{
  font-size:48px;
  font-weight:bold;
  margin:20px;
  animation:logoFloat 3s ease-in-out infinite;
}
@keyframes logoFloat{
  0%{transform:translateY(0)}
  50%{transform:translateY(-8px)}
  100%{transform:translateY(0)}
}

table{
  width:90%;
  margin:auto;
  border-collapse:collapse;
}

th{
  background:#111;
  padding:10px;
  border:1px solid #333;
}

td{
  background:#ddd;
  border:1px solid #555;
  padding:5px;
}

input{
  width:95%;
  border:1px solid #aaa;
  padding:4px;
  background:white;
  text-align:center;
}

/* profit animation */
.profitNum{
  color:#00ff88;
  font-weight:bold;
  display:inline-block;
  animation:bounce .7s infinite alternate;
}
@keyframes bounce{
  from{transform:scale(1)}
  to{transform:scale(1.2)}
}

/* loss animation */
.lossNum{
  color:red;
  font-weight:bold;
  animation:blink 1s infinite;
}
@keyframes blink{
  50%{opacity:0}
}

/* total row (no animation) */
tfoot td{
  background:black;
  color:white;
  font-weight:bold;
}

/* audit */
#auditBox{
  display:none;
  width:90%;
  margin:auto;
  border:1px solid #333;
  padding:10px;
  text-align:left;
  background:#111;
  height:200px;
  overflow:auto;
}

/* mobile */
@media(max-width:768px){
  table{display:none;}
  .mobileRow{
    background:#111;
    border:1px solid #333;
    margin:10px;
    padding:10px;
    text-align:left;
  }
}
</style>
</head>

<body>

<div class="logoText">D<span style="color:red">!</span>CTATOR</div>
<h2>‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏¢‡∏≠‡∏î‡∏ö‡∏≠‡∏•</h2>

<div>
<input id="user" placeholder="Username">
<input id="pass" type="password" placeholder="Password">
<button onclick="login()">Login</button>
<button onclick="logout()">Logout</button>
</div>

<br>

<button onclick="addDay()">+ ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ß‡∏±‡∏ô</button>
<button onclick="save()">üíæ Save</button>
<button onclick="toggleAudit()">Audit Log</button>

<table id="table">
<thead>
<tr>
<th>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà</th>
<th>‡∏ó‡∏∏‡∏ô</th>
<th>‡∏Å‡∏≥‡πÑ‡∏£</th>
<th>-</th>
<th>‡∏£‡∏ß‡∏°</th>
<th>‡∏•‡∏ö‡∏ß‡∏±‡∏ô</th>
</tr>
</thead>

<tbody></tbody>

<tfoot>
<tr>
<td>‡∏£‡∏ß‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</td>
<td id="sum‡∏ó‡∏∏‡∏ô">0</td>
<td id="sum‡∏Å‡∏≥‡πÑ‡∏£">0</td>
<td id="sum‡∏•‡∏ö">0</td>
<td id="sum‡∏£‡∏ß‡∏°">0</td>
<td></td>
</tr>
</tfoot>
</table>

<div id="mobileView"></div>

<h3 onclick="toggleAudit()" style="cursor:pointer">Audit Log</h3>
<div id="auditBox"></div>

<script>

/* accounts */
const ACC={
"Pim888_":"dictator_888_pim",
"Yohan888_":"dictator_yohan_888",
"Jo888_":"Jo_dictator_888",
"Jwish888_":"dictator_Jwish888_",
"Joommeng_":"Joommeng888"
};

let ADMIN=false;

/* login */
function login(){
let u=user.value.trim();
let p=pass.value.trim();

if(ACC[u]===p){
if(localStorage.getItem("lock_"+u)){
alert("‡∏ö‡∏±‡∏ç‡∏ä‡∏µ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏≠‡∏¢‡∏π‡πà");
return;
}
localStorage.setItem("lock_"+u,"1");
localStorage.setItem("admin",u);
ADMIN=true;
log(u+" LOGIN");
alert("login ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à");
}
}

function logout(){
let u=localStorage.getItem("admin");
if(!u)return;
localStorage.removeItem("lock_"+u);
localStorage.removeItem("admin");
ADMIN=false;
log(u+" LOGOUT");
alert("logout");
}

/* add row */
function addDay(){
if(!ADMIN)return alert("login ‡∏Å‡πà‡∏≠‡∏ô");
let r=table.tBodies[0].insertRow();
r.innerHTML=`
<td><input type="date"></td>
<td><input></td>
<td><input></td>
<td><input></td>
<td><span>0</span></td>
<td><button onclick="this.closest('tr').remove();calc()">X</button></td>
`;
}

/* calc */
function fmt(n){return Number(n||0).toLocaleString();}
function parse(v){return Number(v.replace(/,/g,''))||0;}

function calc(){
let rows=document.querySelectorAll("#table tbody tr");

let s1=0,s2=0,s3=0,s4=0;

rows.forEach(r=>{
let t=parse(r.cells[1].children[0].value);
let p=parse(r.cells[2].children[0].value);
let l=parse(r.cells[3].children[0].value);

r.cells[1].children[0].value=fmt(t);
r.cells[2].children[0].value=fmt(p);
r.cells[3].children[0].value=fmt(l);

let sum=t+p-l;

r.cells[4].innerHTML=fmt(sum);

r.cells[2].children[0].className="profitNum";
r.cells[3].children[0].className="lossNum";

s1+=t; s2+=p; s3+=l; s4+=sum;
});

sum‡∏ó‡∏∏‡∏ô.innerText=fmt(s1);
sum‡∏Å‡∏≥‡πÑ‡∏£.innerText=fmt(s2);
sum‡∏•‡∏ö.innerText=fmt(s3);
sum‡∏£‡∏ß‡∏°.innerText=fmt(s4);

buildMobile();
}

/* mobile */
function buildMobile(){
mobileView.innerHTML="";
document.querySelectorAll("#table tbody tr").forEach(r=>{
let box=document.createElement("div");
box.className="mobileRow";
box.innerHTML=`
‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà: ${r.cells[0].children[0].value}<br>
‡∏ó‡∏∏‡∏ô: ${r.cells[1].children[0].value}<br>
‡∏Å‡∏≥‡πÑ‡∏£: ${r.cells[2].children[0].value}<br>
- : ${r.cells[3].children[0].value}<br>
‡∏£‡∏ß‡∏°: ${r.cells[4].innerText}
`;
mobileView.appendChild(box);
});
}

/* save */
function save(){
if(!ADMIN)return alert("login ‡∏Å‡πà‡∏≠‡∏ô");
log(localStorage.getItem("admin")+" SAVE");
alert("saved");
}

/* audit */
function log(t){
let now=new Date().toLocaleString();
auditBox.innerHTML=`[${now}] ${t}<br>`+auditBox.innerHTML;
}

function toggleAudit(){
auditBox.style.display=
auditBox.style.display=="none"?"block":"none";
}

document.addEventListener("input",calc);

</script>
</body>
</html>
