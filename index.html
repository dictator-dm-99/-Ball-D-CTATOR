<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<title>D!CTATOR</title>

<style>
body{
  background:black;
  color:white;
  font-family:Arial;
  text-align:center;
  margin:0;
}

.logoText{
  font-size:48px;
  font-weight:bold;
  margin:20px;
  letter-spacing:3px;
  animation: glitch 1.5s infinite;
  text-shadow:0 0 10px #fff;
}

.logoText span{
  color:red;
  animation: blink 0.8s infinite;
}

@keyframes glitch{
  0%{transform:translate(0);}
  20%{transform:translate(-1px,1px);}
  40%{transform:translate(1px,-1px);}
  60%{transform:translate(-1px,0);}
  80%{transform:translate(1px,1px);}
  100%{transform:translate(0);}
}

@keyframes blink{
  0%,100%{opacity:1;}
  50%{opacity:0.2;}
}

.container{
  width:98%;
  margin:auto;
}

#loginBox input{
  width:140px;
  padding:5px;
}

.dateBar{
  text-align:left;
  margin-bottom:6px;
  font-size:12px;
}

.dateBar input{
  width:130px;
  padding:3px;
}

.leagueBar{
  background:#111;
  border-top:1px solid #444;
  border-bottom:1px solid #444;
  padding:8px;
  display:flex;
  justify-content:center;
  align-items:center;
  gap:8px;
  font-size:18px;
}

.leagueBar img{
  height:26px;
  background:white;
  padding:2px 4px;
  border-radius:4px;
}

table{
  width:100%;
  border-spacing:10px;
}

.block{
  border:2px solid #555;
  background:#111;
}

.block th{
  background:#2b1a00;
  color:#ffcc66;
  font-size:12px;
  padding:6px;
  border:1px solid #333;
}

.block td{
  background:white;
  border:1px solid #999;
}

input{
  width:100%;
  border:none;
  padding:4px;
  text-align:center;
}

button{
  padding:5px 10px;
  cursor:pointer;
}
</style>
</head>

<body>

<div class="logoText">D<span>!</span>CTATOR</div>

<div id="loginBox">
<input id="user" placeholder="Username">
<input id="pass" type="password" placeholder="Password">
<button onclick="login()">Login</button>
<button onclick="logout()">Logout</button>
</div>

<br>

<button id="addBtn" onclick="addRow()" disabled>+ ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÅ‡∏ñ‡∏ß</button>
<button id="saveBtn" onclick="save()" disabled>üíæ Save</button>

<br><br>

<div class="container">

<div class="dateBar">
‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà:
<input type="date">
</div>

<div class="leagueBar">
‡∏û‡∏£‡∏µ‡πÄ‡∏°‡∏µ‡∏¢‡∏£‡πå‡∏•‡∏µ‡∏Å‡∏≠‡∏±‡∏á‡∏Å‡∏§‡∏© (Premier League)
<img src="https://upload.wikimedia.org/wikipedia/en/f/f2/Premier_League_Logo.svg">
</div>

<table id="table">
<tbody></tbody>
</table>

</div>

<script type="module">

import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
import { getDatabase, ref, set, onValue } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-database.js";

const firebaseConfig = {
  apiKey: "AIza...",
  authDomain: "dictator-ball.firebaseapp.com",
  databaseURL: "https://dictator-ball-default-rtdb.asia-southeast1.firebasedatabase.app",
  projectId: "dictator-ball"
};

const app = initializeApp(firebaseConfig);
const db = getDatabase(app);
const dataRef = ref(db,"table");

let admin=false;

window.login=function(){
admin=true;
addBtn.disabled=false;
saveBtn.disabled=false;
}

window.logout=function(){
admin=false;
addBtn.disabled=true;
saveBtn.disabled=true;
}

function buildBlock(data=[], header=false){

let cell=document.createElement("td");
cell.className="block";

let head = header ? `
<tr>
<th>‡πÄ‡∏ß‡∏•‡∏≤</th>
<th>‡∏ó‡∏µ‡∏°‡πÄ‡∏à‡πâ‡∏≤‡∏ö‡πâ‡∏≤‡∏ô</th>
<th>‡∏£‡∏≤‡∏Ñ‡∏≤‡∏ö‡∏≠‡∏•</th>
<th>‡∏ó‡∏µ‡∏°‡πÄ‡∏¢‡∏∑‡∏≠‡∏ô</th>
</tr>` : "";

cell.innerHTML=`
<table style="width:100%;border-collapse:collapse;">
${head}
<tr>
<td><input type="time" value="${data[0]||""}"></td>
<td><input value="${data[1]||""}"></td>
<td><input value="${data[2]||""}"></td>
<td><input value="${data[3]||""}"></td>
</tr>
</table>`;

return cell;
}

function buildRow(rowData=[], header=false){

let r=document.querySelector("#table tbody").insertRow();

for(let i=0;i<5;i++){
let start=i*4;
r.appendChild(buildBlock(rowData.slice(start,start+4), header));
}

let del=document.createElement("td");
del.innerHTML=`<button onclick="removeRow(this)">X</button>`;
r.appendChild(del);
}

function buildHeaderRow(){
buildRow([], true);
}

window.addRow=function(){
if(!admin) return;
buildRow();
}

window.removeRow=function(b){
b.parentNode.parentNode.remove();
}

window.save=function(){

let rows=document.querySelectorAll("#table tbody tr");
let data=[];

rows.forEach(r=>{
let row=[];
r.querySelectorAll("input").forEach(i=>row.push(i.value));
data.push(row);
});

set(dataRef,data);
}

onValue(dataRef,s=>{
let d=s.val();
let tbody=document.querySelector("#table tbody");
tbody.innerHTML="";

buildHeaderRow(); // header ‡πÄ‡∏™‡∏°‡∏≠

if(!d || d.length==0){
for(let i=0;i<3;i++) buildRow();
return;
}

d.forEach(row=>buildRow(row));
});

</script>

</body>
</html>
